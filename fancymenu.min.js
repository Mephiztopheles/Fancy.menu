(function(f,c){Fancy.require({jQuery:false,Fancy:"1.0.2"});var h="FancyMenu",j="1.0.5",d=0,e=false;function a(s,v,n){var o=c("<li/>",{"class":h+"-menu-element"});o.append(c("<span/>",{"class":h+"-menu-icon "+v.icon}));o.append(c("<span/>",{"class":h+"-menu-text",html:n}));var l=v.name,p=v.disabled,r=v.title;if(l){if(typeof l=="function"){l=l.call(s,v)}o.find("."+h+"-menu-text").html(l)}if(typeof r=="function"){r=r.call(s,v)}if(r){o.attr("title",r);if(Fancy.tooltip){Fancy(o).tooltip({ever:true})}}else{if(Fancy.tooltip){var u=Fancy(o).get("tooltip");if(u){u.destroy()}}}if(typeof p=="function"){p=p.call(s,v)}if(v.click&&!v.menu){o.on("click",function(){v.click.call(s,v,o)})}else{if(v.menu){var k=b();o.append(k);for(var q=0;q<v.menu.length;q++){k.append(a(s,v.menu[q],q))}}}if(p){o.addClass("disabled")}return o}function b(){return c("<div/>",{"class":h+"-submenu"})}function g(i,k){var l=this;l.id=d;l.element=i;l.version=j;l.name=h;l.settings=c.extend({},Fancy.settings[h],k);if(!e){e=true;Fancy.version(l)}this.init();d++}g.api=g.prototype={};g.api.version=j;g.api.name=h;g.api.init=function(){var k=this;k.createMenu();k.element.addClass(this.name+"-trigger");k.element.data(h,k);k.element.on("contextmenu."+h+"-"+k.id,function(m){k.onOpen(m);m.preventDefault();m.stopPropagation()});var l,i=1000;k.element.on("touchstart."+h+"-"+k.id,function(m){l=setTimeout(function(){k.onOpen(m)},i);if(k.settings.preventMobileTouch){m.preventDefault()}});k.element.on("touchend."+h+"-"+k.id,function(){if(l){clearTimeout(l)}})};g.api.createMenu=function(){var l=this,r=c("<div/>",{id:h+"-wrapper"}).attr("unselectable","on").css("user-select","none").on("selectstart",false),k=c("<div/>",{id:h+"-inner"}),o=c("<ul/>",{id:h+"-menu"});r.append(k.append(o));for(var q=0;q<l.settings.menu.length;q++){var p=l.settings.menu[q],i=a(l,p,q);o.append(i)}this.menu=r};g.api.onOpen=function(m){var l=this;if(!l.settings.menu.length){return}this.close();this.createMenu();c("body").append(this.menu);c(document).on("mousedown."+h+"-"+l.id+" touchstart."+h+"-"+l.id,function(n){if(c(n.target).is(l.menu)||c(n.target).closest(l.menu).length){return}l.close()});var k=m.pageX||m.originalEvent.touches[0].pageX;var i=m.pageY||m.originalEvent.touches[0].pageY;this.menu.css({left:k+10,top:i+10})};g.api.close=function(){this.menu.remove();c(document).unbind("."+h+"-"+this.id);this.settings.onClose.call(this)};Fancy.settings[h]={menu:[],onClose:function(){},preventMobileTouch:true};Fancy.menu=j;Fancy.api.menu=function(i){return this.set(h,function(k){return new g(k,i)})}})(window,jQuery);